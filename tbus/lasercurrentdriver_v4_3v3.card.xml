<?xml version="1.0" encoding="utf-8"?>
<Card name="Laser Current Driver v4 3v3">
  
  Output current setpoints
  <IntegerParameter name="CurrentA" defaultvalue="0" min="0" max="65535"  OnUnderflow="clip" OnOverflow="clip" abs="on" />
  <IntegerParameter name="CurrentB" defaultvalue="0" min="0" max="65535"  OnUnderflow="clip" OnOverflow="clip" abs="on" />
  
  <IntegerParameter name="RelayA" defaultvalue="0" min="0" max="3"  OnUnderflow="clip" OnOverflow="clip" abs="on" />
  <IntegerParameter name="RelayB" defaultvalue="0" min="0" max="3"  OnUnderflow="clip" OnOverflow="clip" abs="on" />
     "2" is laser on, others laser is off.
   
  <BooleanParameter name="EnableA" defaultvalue="false" />
  <BooleanParameter name="EnableB" defaultvalue="false" />  

  Measurements
  <IntegerParameter name="ReadCurrentA" defaultvalue="0" min="0" max="4095" /> Full range is 0.446V. Use resistor value to convert to current.
  <IntegerParameter name="ReadCurrentB" defaultvalue="0" min="0" max="4095" /> Full range is 0.446V. Use resistor value to convert to current.
  <IntegerParameter name="ReadVoltA" defaultvalue="0" min="0" max="4095" /> Full range is 3.0V
  <IntegerParameter name="ReadVoltB" defaultvalue="0" min="0" max="4095" /> Full range is 3.0V
  <IntegerParameter name="ReadVoltIn" defaultvalue="0" min="0" max="4095" />  Full range is 3.675V
  <IntegerParameter name="TemperatureA" min="-127" max="128" default="0" /> in °C
  <IntegerParameter name="TemperatureB" min="-127" max="128" default="0" /> in °C
  
  Firmware ID
  <IntegerParameter name="ID_Addr" min="0" max="255" default="0" />
  <IntegerParameter name="ID_Data" min="0" max="255" default="0" />
  
  
  <Register name="Get_ID" PreferedMethod="Standard" DefaultDuration="25ns">
    <BusPattern address="+15" direction="w" pattern="ID_Addr[7],ID_Addr[6],ID_Addr[5],ID_Addr[4], ID_Addr[3],ID_Addr[2],ID_Addr[1],ID_Addr[0]" />
    <BusPattern address="+15" direction="r" pattern="ID_Data[7],ID_Data[6],ID_Data[5],ID_Data[4], ID_Data[3],ID_Data[2],ID_Data[1],ID_Data[0]" />
  </Register>  
    
  <Register name="Set Laser Status" PreferedMethod="Default" DefaultDuration="25ns">
      <BusPattern direction="w" pattern="0,0, EnableA, RelayA[1], RelayA[0], EnableB, RelayB[1], RelayB[0]"  />
  </Register>
  
  <Register name="Get Measurements" PreferedMethod="Default" DefaultDuration="25ns">
      <BusPattern direction="r" address="+2" pattern="TemperatureA[7],TemperatureA[6],TemperatureA[5],TemperatureA[4],TemperatureA[3],TemperatureA[2],TemperatureA[1],TemperatureA[0]" />
      <BusPattern direction="r" address="+4" pattern="TemperatureB[7],TemperatureB[6],TemperatureB[5],TemperatureB[4],TemperatureB[3],TemperatureB[2],TemperatureB[1],TemperatureB[0]" />
      <!-- pattern=" 0,CS_ADC, SCLK_ADC,0,0,0,0,0" -->
      <!-- pattern="0,0,0,ReadCurrentA,ReadCurrentB,ReadVoltA,ReadVoltB,ReadVoltIn" --> 
      <BusPattern direction="w" address="+2" pattern="0,1,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[11],ReadCurrentB[11],ReadVoltA[11],ReadVoltB[11],ReadVoltIn[11]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[10],ReadCurrentB[10],ReadVoltA[10],ReadVoltB[10],ReadVoltIn[10]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[9],ReadCurrentB[9],ReadVoltA[9],ReadVoltB[9],ReadVoltIn[9]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[8],ReadCurrentB[8],ReadVoltA[8],ReadVoltB[8],ReadVoltIn[8]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[7],ReadCurrentB[7],ReadVoltA[7],ReadVoltB[7],ReadVoltIn[7]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[6],ReadCurrentB[6],ReadVoltA[6],ReadVoltB[6],ReadVoltIn[6]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[5],ReadCurrentB[5],ReadVoltA[5],ReadVoltB[5],ReadVoltIn[5]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[4],ReadCurrentB[4],ReadVoltA[4],ReadVoltB[4],ReadVoltIn[4]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[3],ReadCurrentB[3],ReadVoltA[3],ReadVoltB[3],ReadVoltIn[3]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[2],ReadCurrentB[2],ReadVoltA[2],ReadVoltB[2],ReadVoltIn[2]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[1],ReadCurrentB[1],ReadVoltA[1],ReadVoltB[1],ReadVoltIn[1]" />
      <BusPattern direction="w" address="+2" pattern="0,0,0,0, 0,0,0,0" />
      <BusPattern direction="w" address="+2" pattern="0,0,1,0, 0,0,0,0" />
      <BusPattern direction="r" address="+0" pattern="0,0,0,ReadCurrentA[0],ReadCurrentB[0],ReadVoltA[0],ReadVoltB[0],ReadVoltIn[0]" />
      <BusPattern direction="w" address="+2" pattern="0,1,0,0, 0,0,0,0" />
  </Register>
  
  <Register name="Set Current Both" PreferedMethod="Default" DefaultDuration="25ns">
         addr=+1 :    0,0,0,CS_Set_Current_B, CS_Set_Current_A, SCLK_Set_Current, SD_Set_Current_B, SD_Set_Current_A
      <!-- pattern=" !Select A, Serial Clock, Data A, !Select B, Data B, Laser A Disable, Laser B Disable, Global Laser Enable" -->
      <BusPattern direction="w" address="+1" pattern="0,0,0, 1,1, 1,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,0,0" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,Power down mode B[1],Power down mode A[1]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,Power down mode B[1],Power down mode A[1]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,Power down mode B[2],Power down mode A[2]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,Power down mode B[2],Power down mode A[2]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[15],CurrentA[15]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[15],CurrentA[15]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[14],CurrentA[14]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[14],CurrentA[14]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[13],CurrentA[13]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[13],CurrentA[13]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[12],CurrentA[12]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[12],CurrentA[12]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[11],CurrentA[11]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[11],CurrentA[11]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[10],CurrentA[10]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[10],CurrentA[10]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[9],CurrentA[9]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[9],CurrentA[9]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[8],CurrentA[8]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[8],CurrentA[8]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[7],CurrentA[7]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[7],CurrentA[7]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[6],CurrentA[6]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[6],CurrentA[6]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[5],CurrentA[5]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[5],CurrentA[5]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[4],CurrentA[4]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[4],CurrentA[4]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[3],CurrentA[3]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[3],CurrentA[3]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[2],CurrentA[2]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[2],CurrentA[2]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[1],CurrentA[1]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[1],CurrentA[1]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 1,CurrentB[0],CurrentA[0]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 0,0, 0,CurrentB[0],CurrentA[0]" />
      <BusPattern direction="w" address="+1" pattern="0,0,0, 1,1, 1,CurrentB[0],CurrentA[0]" />
  </Register>

</Card>